# 概要

**KeyMapSync** は会計処理を意識した軽量ETLライブラリです。

## デモ

売上という関心事を管理しているサブシステムが複数存在し、それぞれ設計思想で作成されていることはよくあります。

**青果サブシステム 売上伝票**（論理削除をサポート）
| sales_id(PK) | sales_date | article_name | price | is_deleted | delete_date |
|:---|:---| :---|---:| :---: |:---|
|1 |2000-01-01 |apple |100 |true |2000-02-01 |
|2 |2000-01-01 |orange |300 |false |NULL |

**魚屋サブシステム 売上伝票**（赤黒をサポート）
| sales_id(PK) |sales_date | article_name | price |
|:---|:---|:---|---:|
|1 |2000-01-01 |tuna |200 |
|2 |2000-01-01 |squid |400 |
|3 |2000-02-01 |tuna |-200 |

これを統一構造（会計サブシステム 売上伝票）で管理したい場合、KeyMapSyncを使用すれば簡単にデータの統合化ができます。

**会計サブシステム 売上伝票**（赤黒をサポート）
| sales_id(PK) |sales_date | article_name | price |
|:---|:---|:---|---:|
|1 |2000-01-01 |apple |100 |
|2 |2000-01-01 |orange |300 |
|3 |2000-01-01 |tuna |200 |
|3 |2000-01-01 |squid |400 |
|4 |2000-02-01 |apple |-100 |
|5 |2000-02-01 |tuna |-200 |

## 特徴

制約は少なめです。

- データ転送元（Datasoutce）とデータ転送先（Destination）のテーブルは同一DBMSインスタンス内に存在する
- データ転送先（Destination）からデータ転送元（Datasoutce）の逆引きが可能
- 差分転送が可能
- 赤黒転送が可能
- データ転送元の制約は「主キーが設定されている」のみ（複合キー可）
- データ転送先の制約は「シーケンスを持っている」のみ

>データ転送元（Datasoutce）とデータ転送先（Destination）のテーブルは同一DBMSインスタンス内に存在する

この条件を満たせない場合は、別のETLを使用して同一DBMSインスタンス内にデータを入れてください。
なお、全期間のデータを保持しておく必要はありません。差分転送の要件外になった期間は削除しても支障ありません。

## 実行環境

.NET

動作検証しているDBMSは PorsgeSQL。

## 使い方

デモの実際に動かしたい場合は以下の手順で行ってください。

・・・・

## 備考

差分転送、赤黒転送を行うためにKeyMapSyncは自動的に制御テーブルを生成します。
同テーブルの命名規則や役割などは以下のとおりです。








